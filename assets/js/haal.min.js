{const a="Content-Type";var haal=new Proxy((b,c={})=>{if((null==c||"object"!=typeof c)&&(c={}),null!=b&&b.constructor===Object&&([c,b]=[b,c.endpoint],!b))throw new Error("road to nowhere? requests need enpoints");return null==c.method&&(c.method="GET"),c.headers||(c.headers={}),haal.headers&&(c.headers=Object.assign({},haal.headers,c.headers)),c.credential||(c.credential="include"),"object"==typeof c.body&&(msgpack&&!c.json?(c.headers[a]="application/msgpack",c.body=msgpack.encode(c.body)):(c.headers[a]="application/json",c.body=JSON.stringify(c.body))),d=>new Promise((e,f)=>{fetch(b,c).then(b=>{const c=b.headers.get(a),g=a=>{b.ok=!1,b.err=a,d&&d(b,a),f(b)},h=a=>{b.out=a,d&&d(b),e(b)};c.includes("/json")?b.json().then(h,g):c.includes("/msgpack")?b.blob().then(a=>{try{haal.filereader.onerror=null,haal.filereader.onload=null,haal.filereader.onerror=g,haal.filereader.onload=a=>{try{h(msgpack.decode(new Uint8Array(a.target.result)))}catch(a){g(a)}finally{haal.filereader.onload=null,haal.filereader.onerror=null,haal.filereader.abort()}},haal.filereader.readAsArrayBuffer(a)}catch(a){g(a)}},g):(c.includes("text/")||c.includes("application/javascript"))&&b.text().then(h,g)})})},{get(a,b){return b in a?Reflect.get(a,b):(a,c={})=>(null!=a&&a.constructor===Object&&([c,a]=[a,c.endpoint]),c.method=b.toUpperCase(),haal(a,c))}});haal.filereader=new FileReader,haal.arrayEqual=(c,a)=>!(c<a||a<c),haal.infinify=(a,b=!1)=>new Proxy(a,{get:(a,c)=>b&&c in a?Reflect.get(a,c):a.bind(null,c)})}